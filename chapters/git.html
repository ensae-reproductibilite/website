<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Pr√©sentation des principes du contr√¥le de version et du travail collaboratif avec Git et son √©cosyst√®me.">

<title>Versionner son code et travailler collaborativement avec Git ‚Äì Mise en production</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-bd706bf7cc79ec682822fd2bf903aab3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
div.callout-application.callout {
  border-left-color: #9c5bd9;
}
div.callout-application.callout-style-default > .callout-header {
  background-color: rgba(156, 91, 217, 0.13);
}
div.callout-application .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-application.callout-style-default .callout-icon::before, div.callout-application.callout-titled .callout-icon::before {
  content: 'üß†';
  background-image: none;
}
</style>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://ensae-reproductibilite.github.io/"> 
<span class="menu-text">Mise en production</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../chapters/introduction.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-les-bases" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Les bases</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-les-bases">    
        <li>
    <a class="dropdown-item" href="../chapters/linux101.html">
 <span class="dropdown-text">Linux 101</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/git.html">
 <span class="dropdown-text">Git</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bonnes-pratiques-de-d√©veloppement" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Bonnes pratiques de d√©veloppement</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-bonnes-pratiques-de-d√©veloppement">    
        <li>
    <a class="dropdown-item" href="../chapters/code-quality.html">
 <span class="dropdown-text">Qualit√© du code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/projects-architecture.html">
 <span class="dropdown-text">Structure des projets</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/big-data.html">
 <span class="dropdown-text">Traitement des donn√©es volumineuses</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/portability.html">
 <span class="dropdown-text">Portabilit√©</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-mise-en-production" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Mise en production</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-mise-en-production">    
        <li>
    <a class="dropdown-item" href="../chapters/yaml101.html">
 <span class="dropdown-text">YAML 101</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/deployment.html">
 <span class="dropdown-text">D√©ploiement</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/mlops.html">
 <span class="dropdown-text">MLOps</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../chapters/application.html"> 
<span class="menu-text">Application</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projets" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Projets</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-projets">    
        <li>
    <a class="dropdown-item" href="../chapters/evaluation.html">
 <span class="dropdown-text">Modalit√©s d‚Äô√©valuation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/galerie.html">
 <span class="dropdown-text">Galerie des projets pass√©s</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/ensae-reproductibilite/website">
 <span class="dropdown-text">Site web</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/ensae-reproductibilite/slides">
 <span class="dropdown-text">Slides</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/ensae-reproductibilite/application">
 <span class="dropdown-text">Application fil rouge</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#le-contr√¥le-de-version" id="toc-le-contr√¥le-de-version" class="nav-link active" data-scroll-target="#le-contr√¥le-de-version">Le contr√¥le de version</a>
  <ul class="collapse">
  <li><a href="#pourquoi-faire" id="toc-pourquoi-faire" class="nav-link" data-scroll-target="#pourquoi-faire">Pourquoi faire ?</a></li>
  <li><a href="#pourquoi-git" id="toc-pourquoi-git" class="nav-link" data-scroll-target="#pourquoi-git">Pourquoi <code>Git</code> <i class="fab fa-git-alt"></i> ?</a></li>
  <li><a href="#pourquoi-github" id="toc-pourquoi-github" class="nav-link" data-scroll-target="#pourquoi-github">Pourquoi <code>GitHub</code> <i class="fab fa-github"></i> ?</a></li>
  </ul></li>
  <li><a href="#des-bases-de-git" id="toc-des-bases-de-git" class="nav-link" data-scroll-target="#des-bases-de-git">Des bases de <code>Git</code> <i class="fab fa-git-alt"></i></a>
  <ul class="collapse">
  <li><a href="#principes-et-commandes-usuelles" id="toc-principes-et-commandes-usuelles" class="nav-link" data-scroll-target="#principes-et-commandes-usuelles">Principes et commandes usuelles</a></li>
  <li><a href="#impl√©mentations" id="toc-impl√©mentations" class="nav-link" data-scroll-target="#impl√©mentations">Impl√©mentations</a></li>
  <li><a href="#bonnes-pratiques" id="toc-bonnes-pratiques" class="nav-link" data-scroll-target="#bonnes-pratiques">Bonnes pratiques</a>
  <ul class="collapse">
  <li><a href="#que-versionne-t-on" id="toc-que-versionne-t-on" class="nav-link" data-scroll-target="#que-versionne-t-on">Que versionne-t-on ?</a></li>
  <li><a href="#messages-des-commits" id="toc-messages-des-commits" class="nav-link" data-scroll-target="#messages-des-commits">Messages des commits</a></li>
  <li><a href="#freq" id="toc-freq" class="nav-link" data-scroll-target="#freq">Fr√©quence des commits</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#git-avanc√©" id="toc-git-avanc√©" class="nav-link" data-scroll-target="#git-avanc√©"><code>Git</code> <i class="fab fa-git-alt"></i> avanc√©</a>
  <ul class="collapse">
  <li><a href="#branches" id="toc-branches" class="nav-link" data-scroll-target="#branches">Branches</a>
  <ul class="collapse">
  <li><a href="#concept" id="toc-concept" class="nav-link" data-scroll-target="#concept">Concept</a></li>
  <li><a href="#branches-locales" id="toc-branches-locales" class="nav-link" data-scroll-target="#branches-locales">Branches locales</a></li>
  <li><a href="#branches-remote" id="toc-branches-remote" class="nav-link" data-scroll-target="#branches-remote">Branches <em>remote</em></a></li>
  </ul></li>
  <li><a href="#workflow-collaboratif" id="toc-workflow-collaboratif" class="nav-link" data-scroll-target="#workflow-collaboratif"><em>Workflow</em> collaboratif</a>
  <ul class="collapse">
  <li><a href="#d√©finition-des-r√¥les-des-contributeurs" id="toc-d√©finition-des-r√¥les-des-contributeurs" class="nav-link" data-scroll-target="#d√©finition-des-r√¥les-des-contributeurs">D√©finition des r√¥les des contributeurs</a></li>
  <li><a href="#d√©veloppement-sur-des-branches-de-court-terme" id="toc-d√©veloppement-sur-des-branches-de-court-terme" class="nav-link" data-scroll-target="#d√©veloppement-sur-des-branches-de-court-terme">D√©veloppement sur des branches de court-terme</a></li>
  <li><a href="#pull-request" id="toc-pull-request" class="nav-link" data-scroll-target="#pull-request">Pull Request</a></li>
  <li><a href="#processus-de-review" id="toc-processus-de-review" class="nav-link" data-scroll-target="#processus-de-review">Processus de <em>review</em></a></li>
  <li><a href="#r√©solution-des-√©ventuels-conflits" id="toc-r√©solution-des-√©ventuels-conflits" class="nav-link" data-scroll-target="#r√©solution-des-√©ventuels-conflits">R√©solution des √©ventuels conflits</a></li>
  <li><a href="#fusion-de-la-branche" id="toc-fusion-de-la-branche" class="nav-link" data-scroll-target="#fusion-de-la-branche">Fusion de la branche</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#contribuer-√†-un-projet-open-source" id="toc-contribuer-√†-un-projet-open-source" class="nav-link" data-scroll-target="#contribuer-√†-un-projet-open-source">Contribuer √† un projet open-source</a>
  <ul class="collapse">
  <li><a href="#utiliser-les-issues" id="toc-utiliser-les-issues" class="nav-link" data-scroll-target="#utiliser-les-issues">Utiliser les <em>issues</em></a></li>
  <li><a href="#proposer-une-pull-request" id="toc-proposer-une-pull-request" class="nav-link" data-scroll-target="#proposer-une-pull-request">Proposer une <em>pull request</em></a></li>
  <li><a href="#respecter-les-r√®gles-de-contribution" id="toc-respecter-les-r√®gles-de-contribution" class="nav-link" data-scroll-target="#respecter-les-r√®gles-de-contribution">Respecter les r√®gles de contribution</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Versionner son code et travailler collaborativement avec Git</h1>
</div>

<div>
  <div class="description">
    <p>Pr√©sentation des principes du contr√¥le de version et du travail collaboratif avec Git et son √©cosyst√®me.</p>
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<details>
<summary>
D√©rouler les <em>slides</em> ci-dessous ou <a href="https://ensae-reproductibilite.github.io/slides/#/git-rappels">cliquer ici</a> pour afficher les slides en plein √©cran.
</summary>
<div id="cb1" class="sourceCode">
<pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
<iframe class="sourceCode yaml code-with-copy" src="https://ensae-reproductibilite.github.io/slides/#/git-rappels">
</iframe>
</div>
</details>
<section id="le-contr√¥le-de-version" class="level1">
<h1>Le contr√¥le de version</h1>
<section id="pourquoi-faire" class="level2">
<h2 class="anchored" data-anchor-id="pourquoi-faire">Pourquoi faire ?</h2>
<p>Le d√©veloppement rapide de la <em>data science</em> au cours de ces derni√®res ann√©es s‚Äôest accompagn√©e d‚Äôune complexification substantielle des projets. Par ailleurs, les projets sont de plus en plus collaboratifs, que ce soit dans le cadre d‚Äô√©quipes dans un contexte professionnel ou bien pour des contributions √† des projets open-source. Naturellement, ces √©volutions doivent nous amener √† modifier nos mani√®res de travailler pour g√©rer cette complexit√© croissante et continuer √† produire de la valeur √† partir des projets de <em>data science</em>.</p>
<p>Pourtant, tout <em>data scientist</em> s‚Äôest parfois demand√© :</p>
<ul>
<li>quelle √©tait la bonne version d‚Äôun programme</li>
<li>qui √©tait l‚Äôauteur d‚Äôun bout de code en particulier</li>
<li>si un changement √©tait important ou juste un essai</li>
<li>comment fusionner des programmes</li>
<li>etc.</li>
</ul>
<p>Et il n‚Äôest pas rare de perdre le fil des versions de son projet lorsque l‚Äôon garde trace de celles-ci de fa√ßon manuelle.</p>
<p><strong>Exemple de contr√¥le de version fait ‚Äú√† la main‚Äù</strong></p>
<p><img src="../fichiers_multiples.png" class="img-fluid"></p>
<p>Pourtant, il existe un outil informatique puissant afin de r√©pondre √† tous ces besoins : la gestion de version (<em>version control system</em> (VCS) en anglais). Ses avantages sont incontestables et permettent de facilement :</p>
<ul>
<li>enregistrer l‚Äôhistorique des modifications d‚Äôun ensemble de fichiers</li>
<li>revenir √† des versions pr√©c√©dentes d‚Äôun ou plusieurs fichiers</li>
<li>rechercher les modifications qui ont pu cr√©er des erreurs</li>
<li>travailler simultan√©ment sur un m√™me fichier sans risque de perte</li>
<li>partager ses modifications et r√©cup√©rer celles des autres</li>
<li>proposer des modifications, les discuter, sans pour autant modifier la derni√®re version existante</li>
<li>identifier les auteurs et la date des modifications</li>
</ul>
<p>En outre, ces outils fonctionnent avec tous les langages informatiques car ils reposent sur la comparaison des lignes et des caract√®res des programmes, ind√©pendamment du langage. En bref, c‚Äôest la bonne mani√®re pour partager des codes et travailler √† plusieurs sur un projet de <em>data science</em>. En r√©alit√©, il ne serait pas exag√©r√© de dire que <strong>l‚Äôutilisation du contr√¥le de version est la bonne pratique la plus fondamentale de tout projet faisant intervenir du code</strong>, et qu‚Äôelle conditionne largement toutes les autres.</p>
</section>
<section id="pourquoi-git" class="level2">
<h2 class="anchored" data-anchor-id="pourquoi-git">Pourquoi <code>Git</code> <i class="fab fa-git-alt"></i> ?</h2>
<p>Plusieurs logiciels de contr√¥le de version existent sur le march√©. En principe, le logiciel Git, d√©velopp√© initialement pour fournir une solution d√©centralis√©e et <em>open-source</em> dans le cadre du d√©veloppement du noyau Linux, est devenu largement h√©g√©monique. Aussi, <strong>toutes les application de ce cours s‚Äôeffectueront √† l‚Äôaide du logiciel Git</strong>.</p>
</section>
<section id="pourquoi-github" class="level2">
<h2 class="anchored" data-anchor-id="pourquoi-github">Pourquoi <code>GitHub</code> <i class="fab fa-github"></i> ?</h2>
<p>Travailler de mani√®re collaborative avec Git implique de synchroniser son r√©pertoire local avec une copie distante, situ√©e sur un serveur h√©bergeant des projets Git. Ce serveur peut √™tre un serveur interne √† une organisation, ou bien √™tre fourni par un h√©bergeur externe. Les deux alternatives les plus populaires en la mati√®re sont GitHub et GitLab. Dans ce cours, <strong>nous utiliserons GitHub, qui est devenu au fil des ann√©es la r√©f√©rence pour l‚Äôh√©bergement des projets open-source</strong>. En pratique, les deux services sont relativement semblables, et tous les concepts pr√©sent√©s se retrouvent sous une forme similaire sur les deux plateformes.</p>
</section>
</section>
<section id="des-bases-de-git" class="level1">
<h1>Des bases de <code>Git</code> <i class="fab fa-git-alt"></i></h1>
<p>Ce cours part du principe que les lecteurs sont d√©j√† familiers avec l‚Äôutilisation de Git, au travers de projets individuels ou collectifs. Aussi, nous rappelons dans cette section les notions essentielles de Git, mais nous ne pr√©senterons pas leur impl√©mentation pratique. Le lecteur souhaitant un rappel plus complet peut par exemple se r√©f√©rer √† la <a href="https://collaboratif-git-formation-insee.netlify.app/index.html">formation au travail collaboratif avec Git et RStudio</a> donn√©e √† l‚ÄôInsee, dont sont issues de nombreuses ressources utilis√©es dans ce chapitre.</p>
<section id="principes-et-commandes-usuelles" class="level2">
<h2 class="anchored" data-anchor-id="principes-et-commandes-usuelles">Principes et commandes usuelles</h2>
<p>Le graphique suivant illustre les principes fondamentaux de Git.</p>
<p><strong>Git tout-en-un</strong> (<a href="http://fabacademy.org/2021/labs/bhubaneswar/students/deepak-chaudhry/ia_PPFP.html">Source</a>) <img src="../gitallinone.png" class="img-fluid"></p>
<p>Lorsqu‚Äôon utilise Git, il est important de <strong>bien distinguer ce qui se passe en local</strong> (sur son poste, sur le serveur sur lequel on travaille‚Ä¶) <strong>de ce qui se passe en <em>remote</em></strong>, i.e.&nbsp;en int√©ragissant avec un serveur distant. Comme le montre le graphique, l‚Äôessentiel du contr√¥le de version se passe en r√©alit√© en local.</p>
<p>En th√©orie, sur un projet individuel, il est m√™me possible de r√©aliser l‚Äôensemble du contr√¥le de version en mode hors-ligne. Pour cela, il suffit d‚Äôindiquer √† Git le projet (dossier) que l‚Äôon souhaite versionner en utilisant la commande <code>git init</code>. Cette commande a pour effet de cr√©er un dossier <code>.git</code> √† la racine du projet, dans lequel Git va stocker tout l‚Äôhistorique du projet (commits, branches, etc.) et permettre de naviguer entre les versions. A cause du <code>.</code> qui pr√©fixe son nom, ce dossier est g√©n√©ralement cach√© par d√©faut, ce qui n‚Äôest pas probl√©matique dans la mesure o√π il n‚Äôy a jamais besoin de le parcourir ou de le modifier √† la main en pratique. Retenez simplement que <strong>c‚Äôest la pr√©sence de ce dossier <code>.git</code> qui fait qu‚Äôun dossier est consid√©r√© comme un projet Git</strong>, et donc que vous pouvez utilisez les commandes usuelles de Git dans ce dossier √† l‚Äôaide d‚Äôun terminal : - <code>git status</code> : affiche les modifications du projet par rapport √† la version pr√©c√©dente ; - <code>git add chemin_du_fichier</code> : ajoute un fichier nouveau ou modifi√© √† la zone de <em>staging</em> de Git en vue d‚Äôun commit ; - <code>git add -A</code> : ajoute tous les fichiers nouveaux ou modifi√©s √† la zone de <em>staging</em> ; - <code>git commit -m "message de commit"</code> : cr√©e un commit, i.e.&nbsp;une photographie des modifications (ajouts, modifications, suppressions) apport√©es au projet depuis la derni√®re version, et lui assigne un message d√©crivant ces changements. Les commits sont l‚Äôunit√© de base de l‚Äôhistorique du projet construit par Git.</p>
<p>En pratique, travailler uniquement en local n‚Äôest pas tr√®s int√©ressant. Pour pouvoir travailler de mani√®re collaborative, on va vouloir <strong>synchroniser les diff√©rentes copies locales du projet √† un r√©pertoire centralis√©</strong>, qui maintient de fait la ‚Äúsource de v√©rit√©‚Äù (<em>single source of truth</em>). M√™me sur un projet individuel, il fait sens de synchroniser son r√©pertoire local √† une copie distante pour assurer l‚Äôint√©grit√© du code de son projet en cas de probl√®me mat√©riel.</p>
<p>En g√©n√©ral, on va donc initialiser le projet dans l‚Äôautre sens : - cr√©er un nouveau projet sur GitHub - g√©n√©rer un <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token">jeton d‚Äôacc√®s</a> (<em>personal access token</em>) - cloner le projet en local via la m√©thode HTTPS : <code>git clone https://github.com/&lt;username&gt;/&lt;project_name&gt;.git</code></p>
<p>Le projet clon√© est un projet Git ‚Äî il contient le dossier <code>.git</code> ‚Äî synchronis√© par d√©faut avec le r√©pertoire distant. On peut le v√©rifier avec la commande <code>remote</code> de Git :</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb1" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> remote <span class="at">-v</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb2" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>origin  https:<span class="op">//</span>github.com<span class="op">/</span>linogaliana<span class="op">/</span>ensae<span class="op">-</span>reproductibilite<span class="op">-</span>website.git (fetch)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>origin  https:<span class="op">//</span>github.com<span class="op">/</span>linogaliana<span class="op">/</span>ensae<span class="op">-</span>reproductibilite<span class="op">-</span>website.git (push)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Le projet local est bien li√© au r√©pertoire distant sur GitHub, auquel Git donne par d√©faut le nom <code>origin</code>. Ce lien permet d‚Äôutiliser les commandes de synchronisation usuelles : - <code>git pull</code> : r√©cup√©rer les changements (<em>fetch</em>) sur le <em>remote</em> et les appliquer au projet local - <code>git push</code> : envoyer les changements locaux sur le <em>remote</em></p>
</section>
<section id="impl√©mentations" class="level2">
<h2 class="anchored" data-anchor-id="impl√©mentations">Impl√©mentations</h2>
<p>Git est un logiciel, qui peut √™tre t√©l√©charg√© sur le <a href="https://git-scm.com/downloads">site officiel</a> pour diff√©rents syst√®mes d‚Äôexploitation. Il existe cependant diff√©rentes mani√®res d‚Äôutiliser Git : - le <strong>client en ligne de commande</strong> : c‚Äôest l‚Äôimpl√©mentation standard, et donc la plus compl√®te. C‚Äôest celle qu‚Äôon utilisera dans ce cours. Le client Git est install√© par d√©faut sur les diff√©rents services du SSP Cloud (VSCode, RStudio, Jupyter, etc.) et peut donc √™tre utilis√© via n‚Äôimporte quel terminal. La <a href="https://docs.sspcloud.fr/onyxia-guide/controle-de-version">documentation</a> du SSP Cloud d√©taille la proc√©dure ; - des <strong>interfaces graphiques</strong> : elles facilitent la prise en main de Git via des guides visuels, mais ne permettent pas de r√©aliser toutes les op√©rations permises par Git - l‚Äôinterface native de <code>RStudio</code> pour les utilisateurs de <code>R</code> : tr√®s compl√®te et stable. La <a href="https://collaboratif-git-formation-insee.netlify.app/index.html">formation au travail collaboratif avec Git et RStudio</a> pr√©sente son utilisation de mani√®re d√©taill√©e ; - le plugin <code>Jupyter-git</code> pour les utilisateurs de <code>Python</code> : elle impl√©mente les principales <em>features</em> de Git, mais s‚Äôav√®re assez instable √† l‚Äôusage.</p>
</section>
<section id="bonnes-pratiques" class="level2">
<h2 class="anchored" data-anchor-id="bonnes-pratiques">Bonnes pratiques</h2>
<p>Le contr√¥le de version est une bonne pratique de d√©veloppement en soi‚Ä¶ mais son utilisation admet elle m√™me des bonnes pratiques qui, lorsqu‚Äôelles sont appliqu√©es, permettent d‚Äôen tirer le plus grand profit.</p>
<section id="que-versionne-t-on" class="level3">
<h3 class="anchored" data-anchor-id="que-versionne-t-on">Que versionne-t-on ?</h3>
<section id="uniquement-des-fichiers-texte" class="level4">
<h4 class="anchored" data-anchor-id="uniquement-des-fichiers-texte">Uniquement des fichiers texte</h4>
<p>A chaque commit, Git calcule les <em>diff√©rences</em> entre les versions successives du projet, afin de ne pas avoir √† stocker une image compl√®te de ce dernier √† chaque fois. C‚Äôest ce qui permet aux projets Git de rester tr√®s l√©gers par d√©faut, et donc aux diff√©rentes op√©rations impliquant le <em>remote</em> (<code>clone</code>, <code>push</code>, <code>pull</code>..) d‚Äô√™tre tr√®s rapides.</p>
<p>La contrepartie de cette l√©g√®ret√© est une contrainte sur les types d‚Äôobjets que l‚Äôon doit versionner. Les diff√©rences sont calculables uniquement sur des fichiers de type texte : codes source, fichiers texte, fichiers de configuration non-sensibles‚Ä¶ Voici donc une liste non-exhaustive des extensions de fichier que l‚Äôon retrouve fr√©quemment dans un d√©p√¥t Git d‚Äôun projet <code>R</code> ou <code>Python</code> : <code>.py</code>, <code>.R</code>, <code>.Rmd</code>, <code>.txt</code>, <code>.json</code>, <code>.xml</code>, <code>.yaml</code>, <code>.toml</code>, et bien d‚Äôautres.</p>
<p>En revanche tous les fichiers binaires ‚Äî pour faire simple, tous les fichiers qui ne peuvent pas √™tre ouverts dans un √©diteur de texte basique sans produire une suite inintelligible de caract√®res ‚Äî n‚Äôont g√©n√©ralement pas destination √† se retrouver sur un d√©p√¥t Git. Du fait de leur formatage (binaire), Git ne peut pas calculer les diff√©rences entre versions pour ces fichiers et c‚Äôest donc le fichier entier qui est sauvegard√© dans l‚Äôhistorique √† chaque changement, ce qui peut tr√®s rapidement faire cro√Ætre la taille du d√©p√¥t. Pour √©viter de versionner ces fichiers par erreur, on va les ajouter au fichier <code>.gitignore</code> (cf.&nbsp;<a href="#gitignore">supra</a>).</p>
</section>
<section id="pas-de-donn√©es" class="level4">
<h4 class="anchored" data-anchor-id="pas-de-donn√©es">Pas de donn√©es</h4>
<p>Comme expliqu√© en introduction, le fil rouge de ce cours sur les bonnes pratiques est l‚Äôimportance de bien s√©parer code, donn√©es et environnement d‚Äôex√©cution afin de favoriser la reproductibilit√© des projets de <em>data science</em>. Ce principe doit s‚Äôappliquer √©galement √† l‚Äôusage du contr√¥le de version, et ce pour diff√©rentes raisons.</p>
<p>A priori, inclure ces donn√©es dans un d√©p√¥t Git peut sembler une bonne id√©e en termes de reproductibilit√©. En <em>machine learning</em> par exemple, on est souvent amen√© √† r√©aliser de nombreuses exp√©rimentations √† partir d‚Äôun m√™me mod√®le appliqu√© √† diff√©rentes transformations des donn√©es initiales, transformations que l‚Äôon pourrait versionner. En pratique, il est g√©n√©ralement pr√©f√©rable de versionner le code qui permet de g√©n√©rer ces transformations et donc les exp√©rimentations associ√©es, dans la mesure o√π le suivi des versions des <em>datasets</em> peut s‚Äôav√©rer rapidement complexe. Pour de plus gros projets, des alternatives sp√©cifiques existent : c‚Äôest le champ du <em>MLOps</em>, domaine en constante expansion qui vise √† rendre les <em>pipelines</em> de <em>machine learning</em> plus reproductibles.</p>
<p>Enfin, la structure m√™me de Git n‚Äôest techniquement pas faite pour le stockage de donn√©es. Si des petits <em>datasets</em> dans un format texte ne poseront pas de probl√®me, des donn√©es volumineuses (√† partir de plusieurs Mo) vont faire cro√Ætre la taille du d√©p√¥t et donc ralentir significativement les op√©rations de synchronisation avec le <em>remote</em>.</p>
</section>
<section id="pas-dinformations-locales" class="level4">
<h4 class="anchored" data-anchor-id="pas-dinformations-locales">Pas d‚Äôinformations locales</h4>
<p>L√† encore en vertu du principe de s√©paration donn√©es / code/ environnement, les donn√©es locales, i.e.&nbsp;sp√©cifiques √† l‚Äôenvironnement de travail sur lequel le code a √©t√© ex√©cut√©, n‚Äôont pas vocation √† √™tre versionn√©es. Par exemple, des fichiers de configuration sp√©cifiques √† un poste de travail, des chemins d‚Äôacc√®s sp√©cifiques √† un ordinateur donn√©, etc. Cela demande une plus grande rigueur lors de la construction du projet, mais garantit par l√† m√™me une meilleure reproductiblit√© pour les futurs utilisateurs du projet.</p>
</section>
<section id="pas-doutputs" class="level4">
<h4 class="anchored" data-anchor-id="pas-doutputs">Pas d‚Äô<em>outputs</em></h4>
<p>Les <em>outputs</em> d‚Äôun projet (graphiques, publications, mod√®le entra√Æn√©‚Ä¶) n‚Äôont pas vocation √† √™tre versionn√©, en vertu des diff√©rents arguments pr√©sent√©s ci-dessus : - il ne s‚Äôagit g√©n√©ralement pas de fichiers de type texte ; - le code source du projet doit dans tous les cas permettre des les reg√©n√©rer √† l‚Äôidentique.</p>
</section>
<section id="gitignore" class="level4">
<h4 class="anchored" data-anchor-id="gitignore">Utiliser un <code>.gitignore</code></h4>
<p>On a list√© pr√©c√©demment un large √©ventail de fichiers qui n‚Äôont, par nature, pas vocation √† √™tre versionn√©. Bien entendu, faire attention √† ne pas ajouter ces diff√©rents fichiers au moment de chaque <code>git add</code> serait assez p√©nible. Git simplifie largement cette proc√©dure en nous donnant la possibilit√© de remplir un fichier <code>.gitignore</code>, situ√© √† la racine du projet, qui sp√©cifie l‚Äôensemble des fichiers et types de fichiers que l‚Äôon ne souhaite pas versionner dans le cadre du projet courant.</p>
<p>De mani√®re g√©n√©rale, il y a pour chaque langage des fichiers que l‚Äôon ne souhaitera jamais versionner. Pour en tenir compte, une premi√®re bonne pratique est de choisir le <code>.gitignore</code> associ√© au langage du projet lors de la cr√©ation du d√©p√¥t sur GitHub. Ce faisant, le projet est initialit√© avec un <code>gitignore</code> d√©j√† existant et pr√©-rempli de chemins et de types de fichiers qui ne sont pas √† versionner. Regardons un extrait du <code>gitignore Python</code> pour comprendre sa structure et son fonctionnement.</p>
<div class="sourceCode" id="cb3" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pip<span class="op">-</span>log.txt</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>__pycache__<span class="op">/</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">*</span>.log</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Chaque ligne du <code>gitignore</code> sp√©cifie un √©l√©ment √† ignorer du contr√¥le de version, √©l√©ment qui peut √™tre un ficher/dossier ou bien une r√®gle concernant un ensemble de fichiers/dossiers. Sauf si sp√©cifi√© explicitement, les chemins sont relatifs √† la racine du projet. L‚Äôextrait du <code>gitignore Python</code> illustre les diff√©rentes possibilit√©s :</p>
<ul>
<li>ligne 1 : ignore le fichier <code>pip-log.txt</code> ;</li>
<li>ligne 2 : ignore le dossier <code>__pycache__/</code> ;</li>
<li>ligne 3 : ignore tous les fichiers dont l‚Äôextension est <code>.log</code>.</li>
</ul>
<p>De nombreuses autres possiblit√©s existent, et sont d√©taill√©es par exemple dans la <a href="https://git-scm.com/book/en/v2/Git-Basics-Recording-Changes-to-the-Repository#_ignoring">documentation de Git</a>.</p>
</section>
</section>
<section id="messages-des-commits" class="level3">
<h3 class="anchored" data-anchor-id="messages-des-commits">Messages des commits</h3>
<p>Le commit est l‚Äôunit√© de temps de Git, et donc fondamentalement ce qui permet de remonter dans l‚Äôhistorique d‚Äôun projet. Afin de pouvoir b√©n√©ficier √† plein de cet avantage de Git, il est capital d‚Äôaccompagner ses commits de messages pertinents, en se pla√ßant dans la perspective que l‚Äôon peut √™tre amen√© plusieurs semaines ou mois plus tard √† vouloir retrouver du code dans l‚Äôhistorique de son projet. Les quelques secondes prises √† chaque commit pour r√©fl√©chir √† une description pertinente du bloc de modifications que l‚Äôon apporte au projet peuvent donc faire gagner un temps pr√©cieux √† la longue.</p>
<p>De nombreuses conventions existent pour r√©diger des messages de commit pertinents. Nous rappelons ici les plus importantes :</p>
<ul>
<li>contenu : le message doit d√©tailler <strong>le pourquoi plut√¥t que le comment</strong> des modifications. Par exemple, plut√¥t que ‚ÄúAjoute le fichier test.py‚Äù, on pr√©f√©rera √©crire ‚ÄúAjout d‚Äôune s√©rie de tests unitaires‚Äù ;</li>
<li>style : le message doit √™tre √† l‚Äôimp√©ratif et former une phrase (sans point √† la fin) ;</li>
<li>longueur : le message du commit doit √™tre court (&lt; 72 caract√®res). S‚Äôil n‚Äôest pas possible de trouver un message de cette taille qui r√©sume le commit, c‚Äôest g√©n√©ralement un signe que le commit regroupe trop de changements (cf.&nbsp;<a href="#freq">point suivant</a>). Le fait de devoir mettre des <code>+</code> ou des <code>&amp;</code> / <code>et</code> dans un message de commit pour s√©parer les changements est √©galement un bon indicateur d‚Äôun commit trop gros.</li>
</ul>
</section>
<section id="freq" class="level3">
<h3 class="anchored" data-anchor-id="freq">Fr√©quence des commits</h3>
<p>De mani√®re g√©n√©rale, il est conseill√© de r√©aliser des commits r√©guliers lorsque l‚Äôon travaille sur un projet. Une r√®gle simple que l‚Äôon peut par exemple appliquer est la suivante : d√®s lors qu‚Äôun ensemble de modifications forment un tout coh√©rent et peuvent √™tre r√©sum√©es par un message simple, il est temps d‚Äôen faire un commit. Cette approche a de nombreux avantages :</p>
<ul>
<li>si l‚Äôon fait suivre chaque commit d‚Äôun <code>push</code> ‚Äî ce qui est conseill√© en pratique ‚Äî on s‚Äôassure de disposer r√©guli√®reemnt d‚Äôune copie de ses travaux, ce qui limite le risque de perte ;</li>
<li>il est plus facile de revenir en arri√®re en cas d‚Äôerreur si les commits portent sur des changements cibl√©s et coh√©rents ;</li>
<li>le processus de <em>review</em> d‚Äôune <em>pull request</em> est facilit√©, car les diff√©rents blocs de modification sont plus clairement s√©par√©s ;</li>
<li>dans une approche d‚Äôint√©gration continue ‚Äî concept que l‚Äôon verra en d√©tail dans le chapitre sur la <a href="[ref []{.quarto-shortcode__-param data-is-shortcode=&quot;1&quot; data-value=&quot;/content/deployment.md&quot; data-raw=&quot;&quot;/content/deployment.md&quot;&quot;} ]{.quarto-shortcode__ data-is-shortcode=&quot;1&quot; data-raw=&quot;{{< ref &quot;/content/deployment.md&quot; >}}&quot;}">mise en production</a> ‚Äî faire des commits et des PR r√©guli√®rement permet de d√©ployer de mani√®re continue les changements en production, et donc d‚Äôobtenir les <em>feedbacks</em> des utilisateurs et d‚Äôadapter plus rapidement si besoin.</li>
</ul>
</section>
</section>
</section>
<section id="git-avanc√©" class="level1">
<h1><code>Git</code> <i class="fab fa-git-alt"></i> avanc√©</h1>
<p>Dans la section pr√©c√©dente, on a pr√©sent√© une mani√®re de travailler assez basique : d√®s lors que l‚Äôon a r√©alis√© un ensemble de modifications coh√©rent sur le projet, on produit un commit, ce qui permet de construire progressivement l‚Äôhistorique du projet. Si cette m√©thode peut tout √† fait convenir √† des petits projets, elle montre rapidement ses limites d√®s lors que les projets gagnent en maturit√© ou deviennent collaboratifs : - on va g√©n√©ralement vouloir garder une version ‚Äúpropre‚Äù du projet (ex : une application fonctionnelle), et exp√©rimenter par ailleurs pour d√©velopper de nouvelles fonctionnalit√©s ; - on peut √™tre amen√© √† travailler √† plusieurs sur les m√™mes fichiers et ce de fa√ßon simultan√©e, ce qui peut g√©n√©rer des conflits complexes √† g√©rer</p>
<p>On le voit bien : <strong>d√®s lors qu‚Äôun projet gagne de l‚Äôampleur, il est imp√©ratif de s‚Äôinterroger en amont sur l‚Äôorganisation du travail et de trouver des mani√®res de collaborer efficacement</strong>. On va pour cela s‚Äôinspirer de mod√®les d‚Äôorganisation (<strong><em>workflows</em></strong>) qui ont fait leurs preuves, ce qui va nous amener √† nous int√©resser √† une des fonctionnalit√©s majeures de Git : les <strong>branches</strong>. On verra √©galement que les services tels que GitHub ou GitLab fournissent des fonctionnalit√©s additionnelles (<strong><em>issues</em></strong>, <strong><em>pull requests</em></strong> et <strong><em>forks</em></strong>) qui permettent de grandement faciliter le travail collaboratif avec Git.</p>
<section id="branches" class="level2">
<h2 class="anchored" data-anchor-id="branches">Branches</h2>
<section id="concept" class="level3">
<h3 class="anchored" data-anchor-id="concept">Concept</h3>
<p>La possibilit√© de cr√©er des branches est l‚Äôune des fonctionnalit√©s majeures de Git. La cr√©ation d‚Äôune branche au sein d‚Äôun projet permet de diverger de la ligne principale de d√©veloppement (g√©n√©ralement appel√©e <code>master</code>, terme tendant √† dispara√Ætre au profit de celui de <code>main</code>) sans impacter cette ligne. Cela permet de s√©parer le nouveau d√©veloppement et de <strong>faire cohabiter plusieurs versions, pouvant √©voluer s√©par√©ment et pouvant √™tre facilement rassembl√©es si n√©cessaire</strong>.</p>
<p>Pour comprendre comment fonctionnent les branches, il nous faut revenir un peu plus en d√©tail sur la mani√®re dont Git stocke l‚Äôhistorique du projet. Comme nous l‚Äôavons vu, l‚Äôunit√© temporelle de Git est le commit, qui correspond √† une photographie √† un instant donn√© de l‚Äô√©tat du projet (<em>snapshot</em>). Chaque commit est uniquement identifi√© par un <em>hash</em>, une longue suite de caract√®res. La commande <code>git log</code>, qui liste les diff√©rents commits d‚Äôun projet, permet d‚Äôafficher ce <em>hash</em> ainsi que diverses m√©tadonn√©es (auteur, date, message) associ√©es au commit.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb4" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> log</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb5" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>commit e58b004d3b68bdf28093fe6ad6036b5d13216e55 (HEAD <span class="op">-&gt;</span> master, origin<span class="op">/</span>master, origin<span class="op">/</span>HEAD)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Author: Lino Galiana <span class="op">&lt;</span>xxx<span class="op">@</span>xxx.fr<span class="op">&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>Date:   Tue Mar <span class="dv">22</span> <span class="dv">14</span>:<span class="dv">34</span>:<span class="dv">0</span><span class="er">4</span> <span class="dv">2022</span> <span class="op">+</span><span class="dv">0</span><span class="er">100</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    ajoute code √©quivalent python</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Une branche est simplement un pointeur vers un commit. Dans l‚Äôexemple pr√©c√©dent, on a imprim√© les informations du dernier commit en date. La branche principale (<code>master</code>) pointe vers ce commit. Si l‚Äôon faisait un nouveau commit, le pointeur se d√©calerait et la branche <code>master</code> pointerait √† pr√©sent sur le nouveau commit.</p>
</section>
<section id="branches-locales" class="level3">
<h3 class="anchored" data-anchor-id="branches-locales">Branches locales</h3>
<p>Dans ce contexte, cr√©er une nouvelle branche (en local) revient simplement √† cr√©er un nouveau pointeur vers un commit donn√©. Supposons que l‚Äôon cr√©e une branche <code>testing</code> √† partir du dernier commit.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="annotated-cell-6" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-annotation-code code-with-copy code-annotated"><code class="sourceCode bash"><a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-6-1" class="code-annotation-target"><a href="#annotated-cell-6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> branch testing</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-6-2" class="code-annotation-target"><a href="#annotated-cell-6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> branch</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="1" data-code-annotation="1">Cr√©e une nouvelle branche</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="2" data-code-annotation="2">Liste les branches existantes</span>
</dd>
</dl>
<div class="sourceCode" id="annotated-cell-7" data-code-line-numbers=""><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-7-1" class="code-annotation-target"><a href="#annotated-cell-7-1" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> master</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-7-2" class="code-annotation-target"><a href="#annotated-cell-7-2" aria-hidden="true" tabindex="-1"></a>  testing</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="1" data-code-annotation="1">La branche sur laquelle on se situe</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="2" data-code-annotation="2">La nouvelle branche cr√©√©e</span>
</dd>
</dl>
<p>La figure suivante illustre l‚Äôeffet de cette cr√©ation sur l‚Äôhistorique Git.</p>
<p><img src="../newbranch.png" class="img-fluid"></p>
<p>D√©sormais, deux branches (<code>master</code> et <code>testing</code>) pointent vers le m√™me commit. Si l‚Äôon effectue √† pr√©sent des commits sur la branche <code>testing</code>, on va diverger de la branche principale, ce qui permet de d√©velopper une nouvelle fonctionnalit√© sans risquer d‚Äôimpacter <code>master</code>.</p>
<p>Pour savoir sur quelle branche on se situe √† instant donn√© ‚Äî et donc sur quelle branche on va commiter ‚Äî Git utilise un pointeur sp√©cial, appel√© <code>HEAD</code>, qui pointe vers la branche courante. On comprend √† pr√©sent mieux la signification de <code>HEAD -&gt; master</code> dans l‚Äôoutput de la commande <code>git log</code> vu pr√©c√©demment. Cet √©l√©ment sp√©cifie la situation <em>locale</em> actuelle et signifie : on se situe actuellement sur la branche <code>master</code>, qui pointe sur le commit <code>e58b004</code>. Pour changer de branche, i.e.&nbsp;d√©placer le <code>HEAD</code>, on utilise la commande <code>git checkout</code>. Par exemple, pour passer de la branche <code>master</code> sur laquelle on est par d√©faut √† la branche <code>testing</code> :</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb6" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout testing  <span class="co"># Changement de branche</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb7" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Switched to branch <span class="st">'testing'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>On se situe d√©sormais sur la branche <code>testing</code>, sur laquelle on peut laisser libre cours √† sa cr√©ativit√© sans risquer d‚Äôimpacer la branche principale du projet. Mais que se passe-t-il si, pendant que l‚Äôon d√©veloppe sur <code>testing</code>, un autre membre du projet commit sur <code>master</code> ? On dit que les historiques ont diverg√©. La figure suivante illustre √† quoi ressemble √† pr√©sent l‚Äôhistorique du projet (et suppose que l‚Äôon est repass√© sur <code>master</code>).</p>
<p><img src="../divergence.png" class="img-fluid"></p>
<p>Cette divergence n‚Äôest pas probl√©matique en soi : il est normal que les diff√©rentes parties et exp√©rimentations d‚Äôun projet avancent √† diff√©rents rythmes. La difficult√© est de savoir comment r√©concillier les diff√©rents changements si l‚Äôon d√©cide que la branche <code>testing</code> doit √™tre int√©gr√©e dans <code>master</code>. Deux situations peuvent survenir : - les modifications op√©r√©es en parall√®le sur les deux branches ne concernent pas les m√™mes fichiers ou les m√™mes parties des fichiers. Dans ce cas, Git est capable de fusionner (<em>merge</em>) les changements automatiquement et tout se passe sans encombre ; - dans le cas contraire, survient un <em>merge conflict</em> : les branches ont diverg√© de telle sorte qu‚Äôil n‚Äôest pas possible pour Git de fusionner les changements automatiquement. Il faut alors r√©soudre les conflits manuellement.</p>
<p>La r√©solution des conflits est une √©tape souvent douloureuse lors de l‚Äôapprentissage de Git. Aussi, nous conseillons dans la mesure du possible de ne pas fusionner des branches manuellement en local avec Git ‚Äî c‚Äôest d‚Äôailleurs pour cette raison que nous n‚Äôavons pas d√©taill√© les commandes pour le faire. Dans les sections suivantes, nous verrons comment une bonne organisation pr√©alable du travail en √©quipe, combin√©e aux outils collaboratifs fournis par GitHub, permet de rendre le processus de fusion des branches largement indolore.</p>
</section>
<section id="branches-remote" class="level3">
<h3 class="anchored" data-anchor-id="branches-remote">Branches <em>remote</em></h3>
<p>Rappellons que toutes les op√©rations que nous avons effectu√©es sur les branches dans cette section se sont pass√©s en local, le r√©pertoire distant est rest√© totalement inchang√©. Pour pouvoir collaborer sur une branche ou bien en faire une <em>pull request</em> (cf.&nbsp;supra), il faut pousser la branche sur le r√©pertoire distant. La commande est simple : <code>git push origin &lt;branche&gt;</code>.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb8" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push origin testing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb9" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Counting objects: <span class="dv">24</span>, done.</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>Delta compression using up to <span class="dv">8</span> threads.</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>Compressing objects: <span class="dv">100</span><span class="op">%</span> (<span class="dv">15</span><span class="op">/</span><span class="dv">15</span>), done.</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>Writing objects: <span class="dv">100</span><span class="op">%</span> (<span class="dv">24</span><span class="op">/</span><span class="dv">24</span>), <span class="fl">1.91</span> KiB <span class="op">|</span> <span class="dv">0</span> <span class="bu">bytes</span><span class="op">/</span>s, done.</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>Total <span class="dv">24</span> (delta <span class="dv">2</span>), reused <span class="dv">0</span> (delta <span class="dv">0</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>To https:<span class="op">//</span>github.com<span class="op">/</span>linogaliana<span class="op">/</span>ensae<span class="op">-</span>reproductibilite<span class="op">-</span>website</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span> [new branch]      testing <span class="op">-&gt;</span> testing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="workflow-collaboratif" class="level2">
<h2 class="anchored" data-anchor-id="workflow-collaboratif"><em>Workflow</em> collaboratif</h2>
<p>Comme on l‚Äôa vu pr√©c√©demment, si le mod√®le des branches de Git semble id√©al pour g√©rer le travail collaboratif et asynchrone, il peut √©galement s‚Äôav√©rer rapidement complexe √† manipuler en l‚Äôabsence d‚Äôune bonne organisation du travail en √©quipe. De nombreux mod√®les (‚Äú<em>workflows</em>‚Äù) existent en la mati√®re, avec des complexit√©s plus ou moins grandes selon la nature du projet. Nous conseillons d‚Äôadopter dans la plupart des cas un mod√®le tr√®s simple : le <a href="https://docs.github.com/en/get-started/quickstart/github-flow">GitHub Flow</a>.</p>
<p>Le <em>GitHub Flow</em> est une m√©thode d‚Äôorganisation minimaliste du travail collaboratif, qui est progressivement devenue la norme dans les projets open-source. Elle est r√©sum√©e par la figure suivante, dont nous d√©taillons par la suite les diff√©rentes √©tapes.</p>
<p><img src="../ghflow.png" class="img-fluid"></p>
<section id="d√©finition-des-r√¥les-des-contributeurs" class="level3">
<h3 class="anchored" data-anchor-id="d√©finition-des-r√¥les-des-contributeurs">D√©finition des r√¥les des contributeurs</h3>
<p>Dans tout projet collaboratif, une premi√®re √©tape essentielle est de bien d√©limiter les r√¥les des diff√©rents contributeurs. Les diff√©rents participants au projet ont en effet g√©n√©ralement des r√¥les diff√©rents dans l‚Äôorganisation, des niveaux diff√©rents de pratique de Git, etc. Il est important de refl√©ter ces diff√©rents r√¥les dans l‚Äôorganisation du travail collaboratif.</p>
<p>Sur les diff√©rents h√©bergeurs de projets Git, cela prend la forme de r√¥les que l‚Äôon attribue aux diff√©rents membres du porjet. Les <em>mainteneurs</em> sont les seuls √† pouvoir √©crire directement sur <code>master</code>. Les <em>contributeurs</em> sont quant √† eux tenus de d√©velopper sur des branches. Cela permet de prot√©ger la branche principale, qui doit rester une version propre et jamais compromise du projet.</p>
<p>Notons que la possibilit√© de donner des r√¥les sur les projets GitHub n‚Äôest possible que dans le cadre d‚Äôorganisations (payantes), donc dans un contexte professionnel ou de projets open-source d‚Äôune certaine ampleur. Pour des petits projets, il est n√©cessaire de s‚Äôastreindre √† une certaine rigueur individuelle pour respecter cette organisation.</p>
</section>
<section id="d√©veloppement-sur-des-branches-de-court-terme" class="level3">
<h3 class="anchored" data-anchor-id="d√©veloppement-sur-des-branches-de-court-terme">D√©veloppement sur des branches de court-terme</h3>
<p>Les contributeurs d√©veloppent uniquement sur des branches. Il est d‚Äôusage de cr√©er une branche par fonctionnalit√©, en lui donnant un nom refl√©tant la fonctionnalit√© en cours de d√©veloppement (ex : <code>ajout-tests-unitaires</code>). Les diff√©rents contributeurs √† la fonctionnalit√© en cours de d√©veloppement font des commits sur la branche, en prenant bien soin de <code>pull</code> r√©guli√®rement les √©ventuels changements pour ne pas risquer de conflits de version. Pour la m√™me raison, il est pr√©f√©rable de faire des branches dites de court-terme, c‚Äôest √† dire propres √† une petite fonctionnalit√©, quite √† diviser une fonctionnalit√© en s√©ries d‚Äôimpl√©mentations. Cela permet de limiter les √©ventuels conflits √† g√©rer lors de la fusion finale de la branche avec <code>master</code>.</p>
</section>
<section id="pull-request" class="level3">
<h3 class="anchored" data-anchor-id="pull-request">Pull Request</h3>
<p>Une fois la s√©rie de modifications termin√©e, vient le temps de rassembler les diff√©rents travaux, par l‚Äôinterm√©diaire de la fusion entre la branche et <code>master</code>. Il faut alors ‚Äúdemander‚Äù de fusionner (<em>pull request</em>) sur GitHub. Cela ouvre une page li√©e √† la <em>pull request</em>, qui rappelle les diff√©rents changements apport√©s et leurs auteurs, et permet d‚Äôentamer une discussion √† propos de ces changements.</p>
</section>
<section id="processus-de-review" class="level3">
<h3 class="anchored" data-anchor-id="processus-de-review">Processus de <em>review</em></h3>
<p>Les diff√©rents membres du projet peuvent donc analyser et commenter les changements, poser des questions, sugg√©rer des modifications, apporter d‚Äôautres contributions, etc. Il est par exemple possible de mentionner un membre de l‚Äô√©quipe par l‚Äôinterm√©diaire de <code>@personne</code>. Il est √©galement possible de proc√©der √† une <em>code review</em>, par exemple par un d√©veloppeur plus exp√©riment√©.</p>
</section>
<section id="r√©solution-des-√©ventuels-conflits" class="level3">
<h3 class="anchored" data-anchor-id="r√©solution-des-√©ventuels-conflits">R√©solution des √©ventuels conflits</h3>
<p>En adoptant cette mani√®re de travailler, <code>master</code> ne sera modifi√©e que via des <em>pull requests</em>. Il ne devrait donc jamais y avoir le moindre conflit √† r√©gler sur <code>master</code>, les seuls conflits possibles se passent sur les branches. Par exemple, dans le cas o√π une autre <em>pull request</em> aurait √©t√© fusionn√©e sur <code>master</code> depuis l‚Äôouverture de la <em>pull request</em> en question.</p>
<p>Dans le cas d‚Äôun conflit √† g√©rer, le conflit doit √™tre r√©solu dans la branche et pas dans <code>master</code>. Voici la marche √† suivre :</p>
<ul>
<li>appliquez le conseil de survie : faites une copie de sauvegarde de votre clone</li>
<li>dans votre clone, placez vous sur la branche en question : <code>git checkout nom-de-la-branche</code></li>
<li>fusionnez <code>master</code> dans la branche : <code>git merge master</code></li>
<li>r√©solvez les √©ventuels conflits dans les fichiers concern√©s</li>
<li>finalisez le commit de merge et poussez-le sur la branche <em>remote</em>, ce qui le fera appara√Ætre dans la <em>pull request</em></li>
</ul>
</section>
<section id="fusion-de-la-branche" class="level3">
<h3 class="anchored" data-anchor-id="fusion-de-la-branche">Fusion de la branche</h3>
<p>Si tout est en ordre, la branche peut √™tre fusionn√©e. Seuls les <em>mainteneurs</em>, qui ont les droits sur <code>master</code>, peuvent fusionner la <em>pull request</em>. En termes d‚Äôhistorique du projet, deux choix sont possibles : - ‚Äú<em>Create a merge commit</em>‚Äù : tous les commits r√©alis√©s sur la branche appara√Ætront dans l‚Äôhistorique du projet ; - ‚Äú<em>Squash and merge</em>‚Äù : les diff√©rents commits r√©alis√©s sur la branche seront rassembl√©s en un commit unique. Cette option est g√©n√©ralement pr√©f√©rable lorsqu‚Äôon utilise des branches de court-terme : elles permettent de garder l‚Äôhistorique plus lisible.</p>
</section>
</section>
</section>
<section id="contribuer-√†-un-projet-open-source" class="level1">
<h1>Contribuer √† un projet open-source</h1>
<p>Il peut arriver que l‚Äôon veuille contribuer √† un projet sur lequel on n‚Äôest pas enregistr√© comme collaborateur. C‚Äôest par exemple le cas d√®s lors que l‚Äôon souhaite contribuer √† un projet open-source. Il existe diff√©rentes mani√®res de proposer une contribution, et les possibilit√©s de contribution sont g√©n√©ralement formalis√©es.</p>
<section id="utiliser-les-issues" class="level2">
<h2 class="anchored" data-anchor-id="utiliser-les-issues">Utiliser les <em>issues</em></h2>
<p>La mani√®re la plus simple de contribuer √† un projet open-source est d‚Äôouvrir une <em>issue</em>. Sur GitHub, cela se fait sur la page du projet, sous l‚Äôonglet <em>Issue</em> (cf.&nbsp;<a href="https://docs.github.com/en/issues/tracking-your-work-with-issues/quickstart">documentation officielle</a>). Les <em>issues</em> peuvent avoir diff√©rentes nature : - suggestion d‚Äôam√©lioration (sans code) - notification de bug - rapports d‚Äôexp√©rience - etc.</p>
<p>Les <em>issues</em> sont une mani√®re tr√®s peu couteuse de contributer √† un projet, mais leur importance est capitale, dans la mesure o√π il est impossible pour les d√©veloppeurs d‚Äôun projet de penser en amont √† toutes les utilisations possibles et donc tous les bugs possibles d‚Äôune application.</p>
</section>
<section id="proposer-une-pull-request" class="level2">
<h2 class="anchored" data-anchor-id="proposer-une-pull-request">Proposer une <em>pull request</em></h2>
<p>Une autre mani√®re, plus ambitieuse, de contribuer √† l‚Äôopen source est de proposer des <em>pull requests</em>. Concr√®tement, l‚Äôid√©e est de proposer une am√©lioration ou bien de r√©soudre un bug sous forme de code, que les mainteneurs du projet peuvent ensuite d√©cider d‚Äôint√©grer au code existant.</p>
<p>La proc√©dure pour proposer une <em>pull request</em> √† un projet sur lequel on n‚Äôa aucun droit est tr√®s similaire √† celle d√©crite ci-dessus dans le cas normal. La principale diff√©rence est que, du fait de l‚Äôabsence de droits, il est impossible de pousser une branche locale sur le r√©pertoire du projet. On va donc devoir cr√©er au pr√©alable un <em>fork</em>, i.e.&nbsp;une copie du projet que l‚Äôon cr√©e dans son espace personnel sur GitHub. C‚Äôest sur cette copie que l‚Äôon va appliquer la proc√©dure d√©crite pr√©c√©demment, en prenant bien soin de travailler sur une branche et non sur <code>master</code>. Une fois les modifications pertinentes effectu√©es sur la branche du <em>fork</em>, GitHub propose de cr√©er une <em>pull request</em> sur le d√©p√¥t original. Cette <em>pull request</em> sera alors visible des mainteneurs du projet, qui pourront l‚Äô√©valuer et d√©cider d‚Äôadopter (ou non) les changements propos√©s.</p>
</section>
<section id="respecter-les-r√®gles-de-contribution" class="level2">
<h2 class="anchored" data-anchor-id="respecter-les-r√®gles-de-contribution">Respecter les r√®gles de contribution</h2>
<p>Vouloir contribuer √† un projet open-source est tr√®s louable, mais ne peut pas pour autant se faire n‚Äôimporte comment. Un projet est constitu√© de personnes, qui ont d√©velopp√© ensemble une mani√®re de travailler, des standards de bonnes pratiques, etc. Pour s‚Äôassurer que sa contribution ne reste pas lettre morte, il est indispensable de s‚Äôimpr√©gner un minimum de la culture du projet.</p>
<p>Pour faciliter les contributions, les projets open-source sp√©cifient bien souvent la mani√®re dont les utilisateurs peuvent contribuer ainsi que le format attendu. En g√©n√©ral, ces r√®gles de contribution sont sp√©cifi√©es dans un fichier <code>CONTRIBUTING.md</code> situ√© √† la racine du projet GitHub, ou a d√©faut dans le <code>README</code> du projet. Il est essentiel de bien lire ce document s‚Äôil existe afin de s‚Äôassurer de proposer des contributions pertinentes.</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ensae-reproductibilite\.github\.io\/website\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>