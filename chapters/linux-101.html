<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Introduction √† l‚Äôutilisation du terminal Linux, un outil essentiel pour le data scientist qui s‚Äôint√©resse √† la mise en production.">

<title>Linux 101 ‚Äì Mise en production</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-957390e16f8056bf57452af51c800dd0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
div.callout-application.callout {
  border-left-color: #9c5bd9;
}
div.callout-application.callout-style-default > .callout-header {
  background-color: rgba(156, 91, 217, 0.13);
}
div.callout-application .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-application.callout-style-default .callout-icon::before, div.callout-application.callout-titled .callout-icon::before {
  content: 'üß†';
  background-image: none;
}
</style>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://ensae-reproductibilite.github.io/"> 
<span class="menu-text">Mise en production</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../chapters/introduction.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-les-bases" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Les bases</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-les-bases">    
        <li>
    <a class="dropdown-item" href="../chapters/linux-101.html">
 <span class="dropdown-text">Linux 101</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/git.html">
 <span class="dropdown-text">Git</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bonnes-pratiques-de-d√©veloppement" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Bonnes pratiques de d√©veloppement</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-bonnes-pratiques-de-d√©veloppement">    
        <li>
    <a class="dropdown-item" href="../chapters/code-quality.html">
 <span class="dropdown-text">Qualit√© du code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/projects-architecture.html">
 <span class="dropdown-text">Structure des projets</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/big-data.html">
 <span class="dropdown-text">Traitement des donn√©es volumineuses</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/portability.html">
 <span class="dropdown-text">Portabilit√©</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-mise-en-production" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Mise en production</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-mise-en-production">    
        <li>
    <a class="dropdown-item" href="../chapters/deployment.html">
 <span class="dropdown-text">D√©ploiement</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/mlops.html">
 <span class="dropdown-text">MLOps</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../chapters/application.html"> 
<span class="menu-text">Application</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projets" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Projets</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-projets">    
        <li>
    <a class="dropdown-item" href="../chapters/evaluation.html">
 <span class="dropdown-text">Modalit√©s d‚Äô√©valuation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/galerie.html">
 <span class="dropdown-text">Galerie des projets pass√©s</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/ensae-reproductibilite/website">
 <span class="dropdown-text">Site web</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/ensae-reproductibilite/slides">
 <span class="dropdown-text">Slides</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/ensae-reproductibilite/application">
 <span class="dropdown-text">Application fil rouge</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#le-terminal-linux" id="toc-le-terminal-linux" class="nav-link active" data-scroll-target="#le-terminal-linux">Le terminal Linux</a>
  <ul class="collapse">
  <li><a href="#pourquoi-sint√©resser-au-terminal-linux" id="toc-pourquoi-sint√©resser-au-terminal-linux" class="nav-link" data-scroll-target="#pourquoi-sint√©resser-au-terminal-linux">Pourquoi s‚Äôint√©resser au terminal Linux ?</a></li>
  <li><a href="#environnement-de-travail" id="toc-environnement-de-travail" class="nav-link" data-scroll-target="#environnement-de-travail">Environnement de travail</a></li>
  <li><a href="#introduction-au-terminal" id="toc-introduction-au-terminal" class="nav-link" data-scroll-target="#introduction-au-terminal">Introduction au terminal</a></li>
  <li><a href="#notions-de-filesystem" id="toc-notions-de-filesystem" class="nav-link" data-scroll-target="#notions-de-filesystem">Notions de <em>filesystem</em></a></li>
  <li><a href="#lancer-des-commandes" id="toc-lancer-des-commandes" class="nav-link" data-scroll-target="#lancer-des-commandes">Lancer des commandes</a>
  <ul class="collapse">
  <li><a href="#navigation-au-sein-du-filesystem" id="toc-navigation-au-sein-du-filesystem" class="nav-link" data-scroll-target="#navigation-au-sein-du-filesystem">Navigation au sein du <em>filesystem</em></a></li>
  <li><a href="#manipulation" id="toc-manipulation" class="nav-link" data-scroll-target="#manipulation">Manipulation de fichiers</a></li>
  <li><a href="#lancement" id="toc-lancement" class="nav-link" data-scroll-target="#lancement">Lancement de programmes</a></li>
  </ul></li>
  <li><a href="#variables-denvironnement" id="toc-variables-denvironnement" class="nav-link" data-scroll-target="#variables-denvironnement">Variables d‚Äôenvironnement</a></li>
  <li><a href="#permissions" id="toc-permissions" class="nav-link" data-scroll-target="#permissions">Permissions</a></li>
  <li><a href="#les-scripts-shell" id="toc-les-scripts-shell" class="nav-link" data-scroll-target="#les-scripts-shell">Les scripts shell</a></li>
  <li><a href="#gestionnaire-de-paquets" id="toc-gestionnaire-de-paquets" class="nav-link" data-scroll-target="#gestionnaire-de-paquets">Gestionnaire de paquets</a></li>
  <li><a href="#tricks" id="toc-tricks" class="nav-link" data-scroll-target="#tricks"><em>Tricks</em></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Linux 101</h1>
</div>

<div>
  <div class="description">
    <p>Introduction √† l‚Äôutilisation du terminal Linux, un outil essentiel pour le data scientist qui s‚Äôint√©resse √† la mise en production.</p>
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="le-terminal-linux" class="level1">
<h1>Le terminal Linux</h1>
<section id="pourquoi-sint√©resser-au-terminal-linux" class="level2">
<h2 class="anchored" data-anchor-id="pourquoi-sint√©resser-au-terminal-linux">Pourquoi s‚Äôint√©resser au terminal Linux ?</h2>
<p>Le terminal (ou ligne de commande) est une console interactive qui permet de lancer des commandes. Il existe dans la plupart des syst√®mes d‚Äôexploitation (y compris avec Windows !). Mais comme il a la r√©putation d‚Äô√™tre aust√®re et complexe, on utilise plut√¥t des interfaces graphiques pour effectuer nos op√©rations informatiques quotidiennes.</p>
<p>Pourtant, avoir des notions quant √† l‚Äôutilisation d‚Äôun terminal est une vraie source d‚Äôautonomie, dans la mesure o√π celui-ci permet de g√©rer bien plus finement les commandes que l‚Äôon r√©alise. Pour les data scientists qui s‚Äôint√©ressent aux bonnes pratiques et √† la mise en production, sa ma√Ætrise est essentielle. Les raisons sont multiples :</p>
<ul>
<li><p>les interfaces graphiques des logiciels sont g√©n√©ralement limit√©es par rapport √† l‚Äôutilisation du programme en ligne de commande. C‚Äôest par exemple le cas de <code>Git</code> et de <code>Docker</code>. Dans les deux cas, seul le client en ligne de commande permet de r√©aliser toutes les op√©rations permises par le logiciel ;</p></li>
<li><p>mettre un projet de <em>data science</em> en production n√©cessite d‚Äôutiliser un serveur, qui le rend disponible en permanence √† son public potentiel. Or l√† o√π Windows domine le monde des ordinateurs personnels, une large majorit√© des serveurs et des infrastructures <em>cloud</em> fonctionnent sous <code>Linux</code> ;</p></li>
<li><p>les principaux langages de programmation des <em>data scientists</em> (<i class="fa-brands fa-python" aria-label="python"></i>, <i class="fa-brands fa-r-project" aria-label="r-project"></i>, etc. ) visent √† simplifier l‚Äôex√©cution d‚Äôop√©rations complexes par le biais de la ligne de commande mais h√©ritent n√©anmoins de sa logique. Utiliser la ligne de commande permet de gagner en aisance dans son travail de programmation ;</p></li>
<li><p>plus g√©n√©ralement, une utilisation r√©guli√®re du terminal est source d‚Äôune meilleure compr√©hension du fonctionnement d‚Äôun syst√®me de fichiers et de l‚Äôex√©cution des processus sur un ordinateur. Ces connaissances s‚Äôav√®rent tr√®s utiles dans la pratique quotidienne du <em>data scientist</em>, qui n√©cessite de plus en plus de d√©velopper dans diff√©rents environnements d‚Äôex√©cution.</p></li>
</ul>
<p>Dans le cadre de ce cours, on s‚Äôint√©ressera particuli√®rement au terminal Linux puisque l‚Äô√©crasante majorit√©, si ce n‚Äôest l‚Äôensemble, des serveurs de mise en production s‚Äôappuient sur un syst√®me Linux.</p>
</section>
<section id="environnement-de-travail" class="level2">
<h2 class="anchored" data-anchor-id="environnement-de-travail">Environnement de travail</h2>
<p>Diff√©rents environnements de travail peuvent √™tre utilis√©s pour apprendre √† se servir d‚Äôun terminal Linux :</p>
<ul>
<li><p>le <a href="https://datalab.sspcloud.fr">SSP Cloud</a>. Dans la mesure o√π les exemples de mise en production du cours seront illustr√©es sur cet environnement, nous recommandons de l‚Äôutiliser d√®s √† pr√©sent pour se familiariser. Le terminal est accessible √† partir de diff√©rents services (RStudio, Jupyter, etc.), mais nous recommandons d‚Äôutiliser le terminal d‚Äôun service VSCode, dans la mesure o√π se servir d‚Äôun <a href="https://fr.wikipedia.org/wiki/Environnement_de_d%C3%A9veloppement">IDE</a> pour organiser notre code est en soi d√©j√† une bonne pratique ;</p></li>
<li><p><a href="https://katacoda.com/scenario-examples/courses/environment-usages/ubuntu-2004">Katacoda</a>, un bac √† sable dans un syst√®me Ubuntu, la distribution Linux la plus populaire ;</p></li>
<li><p>sur Windows : Git Bash (√©mulation minimaliste d‚Äôun terminal Linux), qui est install√©e par d√©faut avec <code>Git</code>.</p></li>
</ul>
</section>
<section id="introduction-au-terminal" class="level2">
<h2 class="anchored" data-anchor-id="introduction-au-terminal">Introduction au terminal</h2>
<p>Lan√ßons un terminal pour pr√©senter son fonctionnement basique. On prend pour exemple le terminal d‚Äôun service VSCode lanc√© via le SSP Cloud (<em>Application Menu</em> tout en haut √† gauche de VSCode -&gt; <em>Terminal</em> -&gt; <em>New Terminal</em>). Voici √† quoi ressemble le terminal en question.</p>
<p><img src="../terminal.png" class="img-fluid"></p>
<p>D√©crivons d‚Äôabord les diff√©rentes inscriptions qui arrivent √† l‚Äôinitialisation :</p>
<ul>
<li><code>(base)</code> : cette inscription n‚Äôest pas directement li√©e au terminal, elle provient du fait que l‚Äôon utilise un environnement <code>conda</code>. Nous verrons le fonctionnement des environnements virtuels en d√©tail dans le chapitre sur la <a href="XXXXXXXX">portabilit√©</a> ;</li>
<li><code>coder@vscode-824991-64744dd6d8-zbgv5</code> : le nom de l‚Äôutilisateur (ici <code>coder</code>) et le nom de la machine (ici, un conteneur, notion que l‚Äôon verra l√† encore dans le chapitre sur la <a href="XXXXXX">portabilit√©</a></li>
<li><code>~/work</code> : le chemin du r√©pertoire courant, i.e.&nbsp;√† partir duquel va √™tre lanc√©e toute commande. On comprendra mieux la signification de ce chemin dans la section suivante.</li>
</ul>
<p>Pour √©viter la lourdeur des images et permettre de copier/coller facilement les commandes, on repr√©sentera dans la suite du tutoriel (et du cours) le terminal du service VSCode par des bandes de texte sur fond noir, comme dans l‚Äôexemple suivant. Les lignes commen√ßant par un <code>$</code> sont celles avec lesquelles une commande est lanc√©e, et les lignes sans <code>$</code> repr√©sentent le r√©sultat d‚Äôune commande. Attention √† ne pas inclure le <code>$</code> lorsque vous lancez les commandes, il sert simplement √† diff√©rencier celles-ci des r√©sultats.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb1" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"une petite illustration"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb2" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>une petite illustration</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="notions-de-filesystem" class="level2">
<h2 class="anchored" data-anchor-id="notions-de-filesystem">Notions de <em>filesystem</em></h2>
<p>Le terme <em>filesystem</em> (syst√®me de fichiers) d√©signe la mani√®re dont sont organis√©s les fichiers au sein d‚Äôun syst√®me d‚Äôexploitation. Cette structure est hi√©rarchique, en forme d‚Äôarbre :</p>
<ul>
<li>elle part d‚Äôun r√©pertoire racine (le dossier qui contient tous les autres) ;</li>
<li>contient des dossiers ;</li>
<li>les dossiers peuvent contenir √† leur tour des dossiers (sous-dossiers) ou des fichiers.</li>
</ul>
<p>Int√©ressons nous √† la structure du <em>filesystem</em> Linux standard.</p>
<p><a href="../linux_fs.jpg"><img src="../linux_fs.jpg" height="300"></a></p>
<p>Source : <a href="https://commons.wikimedia.org/wiki/File:Linux_file_system_foto_no_exif_(1).jpg">commons.wikimedia.org</a></p>
<p>Quelques observations :</p>
<ul>
<li>la racine (<em>root</em>) sur Linux s‚Äôappelle <code>/</code>, l√† o√π elle s‚Äôappelle <code>C:\</code> par d√©faut sur Windows ;</li>
<li>le r√©pertoire racine contient un ensemble de sous-dossiers, dont la plupart ont un r√¥le essentiellement technique. Il est tout de m√™me utile d‚Äôen d√©crire les principaux :
<ul>
<li><code>/bin</code> : contient les binaires, i.e.&nbsp;les programmes ex√©cutables ;</li>
<li><code>/etc</code> : contient les fichiers de configuration ;</li>
<li><code>/home</code> : contient l‚Äôensemble des dossiers et fichiers personnels des diff√©rents utilisateurs. Chaque utilisateur a un r√©pertoire dit ‚ÄúHOME‚Äù qui a pour chemin <code>/home/&lt;username&gt;</code> Ce r√©pertoire est souvent repr√©sent√© par le symbole <code>~</code>. C‚Äô√©tait notamment le cas dans l‚Äôillustration du terminal VSCode ci-dessus, ce qui signifie qu‚Äôon se trouvait formellement dans le r√©pertoire <code>/home/coder/work</code>, <code>coder</code> √©tant l‚Äôutilisateur par d√©faut du service VSCode sur le SSP Cloud.</li>
</ul></li>
</ul>
<p>Chaque dossier ou fichier est repr√©sent√© par un chemin d‚Äôacc√®s, qui correspond simplement √† sa position dans le <em>filesystem</em>. Il existe deux moyens de sp√©cifier un chemin :</p>
<ul>
<li>en utilisant un chemin <strong>absolu</strong>, c‚Äôest √† dire en indiquant le chemin complet du dossier ou fichier depuis la racine. En Linux, on reconna√Æt donc un chemin absolu par le fait qu‚Äôil commence forc√©ment par <code>/</code>.</li>
<li>en utilisant un chemin <strong>relatif</strong>, c‚Äôest √† dire en indiquant le chemin du dossier ou fichier <em>relativement</em> au r√©pertoire courant.</li>
</ul>
<p>Comme tout ce qui touche de pr√®s ou de loin au terminal, la seule mani√®re de bien comprendre ces notions est de les appliquer. Les exercices de fin de chapitre vous permettront d‚Äôappliquer ces concepts √† des cas pratiques.</p>
</section>
<section id="lancer-des-commandes" class="level2">
<h2 class="anchored" data-anchor-id="lancer-des-commandes">Lancer des commandes</h2>
<p>Le r√¥le d‚Äôun terminal est de lancer des commandes. Ces commandes peuvent √™tre class√©es en trois grandes cat√©gories :</p>
<ul>
<li>navigation au sein du <em>filesystem</em></li>
<li>manipulations de fichiers (cr√©er, lire, modifier des dossiers/fichiers)</li>
<li>lancement de programmes</li>
</ul>
<section id="navigation-au-sein-du-filesystem" class="level3">
<h3 class="anchored" data-anchor-id="navigation-au-sein-du-filesystem">Navigation au sein du <em>filesystem</em></h3>
<p>Lorsque l‚Äôon lance un programme √† partir du terminal, celui-ci a pour r√©f√©rence le r√©pertoire courant dans lequel on se trouve au moment du lancement. Par exemple, si l‚Äôon ex√©cute un script Python en se trouvant dans un certain r√©pertoire, tous les chemins des fichiers utilis√©s dans le script seront relatifs au r√©pertoire courant d‚Äôex√©cution ‚Äî √† moins d‚Äôutiliser uniquement des chemins absolus, ce qui n‚Äôest pas une bonne pratique en termes de reproductibilit√© puisque cela lie votre projet √† la structure de votre <em>filesystem</em> particulier.</p>
<p>Ainsi, la tr√®s grande majorit√© des op√©rations que l‚Äôon est amen√© √† r√©aliser dans un terminal consiste simplement √† se d√©placer au sein du <em>filesystem</em>. Les commandes principales pour naviguer et se rep√©rer dans le <em>filesystem</em> sont pr√©sent√©es dans la table suivante.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 35%">
<col style="width: 65%">
</colgroup>
<thead>
<tr class="header">
<th>Commande</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pwd</code></td>
<td>afficher (Print Working Directory) le chemin (absolu) du dossier courant</td>
</tr>
<tr class="even">
<td><code>cd chemin</code></td>
<td>changer (Change Directory) de dossier courant</td>
</tr>
<tr class="odd">
<td><code>ls</code></td>
<td>lister les fichiers dans le dossier courant</td>
</tr>
</tbody>
</table>
<p>La commande <code>cd</code> accepte aussi bien des chemins absolus que des chemins relatifs. En pratique, il est assez p√©nible de manipuler des chemins absolus, qui peuvent facilement √™tre tr√®s longs. On utilisera donc essentiellement des chemins relatifs, ce qui revient √† se d√©placer √† partir du r√©pertoire courant. Pour se faire, voici quelques utilisations tr√®s fr√©quentes de la commande <code>cd</code>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 35%">
<col style="width: 65%">
</colgroup>
<thead>
<tr class="header">
<th>Commande</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>cd ..</code></td>
<td>remonter d‚Äôun niveau dans l‚Äôarborescence (dossier parent)</td>
</tr>
<tr class="even">
<td><code>cd ~</code></td>
<td>revenir dans le r√©pertoire HOME de l‚Äôutilisateur courant</td>
</tr>
</tbody>
</table>
<p>La premi√®re commande est l‚Äôoccasion de revenir sur une convention d‚Äô√©criture importante pour les chemins relatifs :</p>
<ul>
<li><code>.</code> repr√©sente le r√©pertoire courant. Ainsi, <code>cd .</code> revient √† changer de r√©pertoire courant‚Ä¶ pour le r√©pertoire courant, ce qui bien s√ªr ne change rien. Mais le <code>.</code> est tr√®s utile pour la copie de fichiers (cf.&nbsp;<a href="#manipulation">section suivante</a>) ou encore lorsque l‚Äôon doit passer des param√®tres √† un programme (cf.&nbsp;section <a href="#lancement">Lancement de programmes</a>) ;</li>
<li><code>..</code> repr√©sente le r√©pertoire parent du r√©pertoire courant.</li>
</ul>
<p>Ces diff√©rentes commandes constituent la tr√®s grande majorit√© des usages dans un terminal. Il est essentiel de les pratiquer jusqu‚Äô√† ce qu‚Äôelles deviennent une seconde nature.</p>
</section>
<section id="manipulation" class="level3">
<h3 class="anchored" data-anchor-id="manipulation">Manipulation de fichiers</h3>
<p>Les commandes suivantes permettent de manipuler le <em>filesystem</em>. Il en existe beaucoup d‚Äôautres, mais elles couvrent la plupart des besoins.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Commande</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>cp fichierdepart fichierarrivee</code></td>
<td>copier (CoPy) un fichier</td>
</tr>
<tr class="even">
<td><code>mv fichierdepart fichierarrivee</code></td>
<td>d√©placer (MoVe) un fichier</td>
</tr>
<tr class="odd">
<td><code>rm nomdufichier</code></td>
<td>supprimer (ReMove) un fichier</td>
</tr>
<tr class="even">
<td><code>cat nomdufichier</code></td>
<td>afficher le contenu du fichier</td>
</tr>
<tr class="odd">
<td><code>mkdir nomdudossier</code></td>
<td>cr√©er (MaKe DIRectory) un dossier</td>
</tr>
<tr class="even">
<td><code>touch nomdufichier</code></td>
<td>cr√©er un fichier vide</td>
</tr>
</tbody>
</table>
<p>Dans la mesure o√π il est g√©n√©ralement possible de r√©aliser toutes ces op√©rations √† l‚Äôaide d‚Äôinterfaces graphiques (notamment, l‚Äôexplorateur de fichiers), celles-ci sont moins essentielles que celles permettant de se d√©placer dans le <em>filesystem</em>. Nous vous recommandons malgr√© tout de les pratiquer √©galement, et ce pour plusieurs raisons :</p>
<ul>
<li>effectuer un maximum d‚Äôop√©rations via le terminal permet de bien comprendre son fonctionnement et donc de gagner en autonomie ;</li>
<li>en devenant efficient sur ces commandes, vous vous rendrez compte que manipuler le <em>filesystem</em> via le terminal est en fait plus rapide que via une interface graphique ;</li>
<li>lorsque l‚Äôon est amen√© √† manipuler un terminal pour interagir avec un serveur, il n‚Äôy a souvent pas la moindre interface graphique, auquel cas il n‚Äôy a pas d‚Äôautre choix que d‚Äôop√©rer uniquement √† partir du terminal.</li>
</ul>
</section>
<section id="lancement" class="level3">
<h3 class="anchored" data-anchor-id="lancement">Lancement de programmes</h3>
<p>Le r√¥le du terminal est de lancer des programmes. Lancer un programme se fait √† partir d‚Äôun fichier dit ex√©cutable, qui peut √™tre de deux formes :</p>
<ul>
<li>un <strong>binaire</strong>, i.e.&nbsp;un programme dont le code n‚Äôest pas lisible par l‚Äôhumain ;</li>
<li>un <strong>script</strong>, i.e.&nbsp;un fichier texte contenant une s√©rie d‚Äôinstructions √† ex√©cuter. Le langage du terminal Linux est le <code>shell</code>, et les scripts associ√©s ont pour extension <code>.sh</code>.</li>
</ul>
<p>Dans les deux cas, la syntaxe de lancement d‚Äôune commande est : le nom de l‚Äôex√©cutable, suivi d‚Äô√©ventuels param√®tres, s√©par√©s par des espaces. Par exemple, la commande <code>python monscript.py</code> ex√©cute le binaire <code>python</code> et lui passe comme unique argument le nom d‚Äôun script <code>.py</code> (contenu dans le r√©pertoire courant), qui va donc √™tre ex√©cut√© via <code>Python</code>. De la m√™me mani√®re, toutes les commandes vues pr√©c√©demment pour se d√©placer dans le <em>filesystem</em> ou manipuler des fichiers sont des ex√©cutables et fonctionnent donc selon ce principe. Par exemple, <code>cp fichierdepart fichierarrivee</code> lance le binaire <code>cp</code> en lui passant deux arguments : le chemin du fichier √† copier et le chemin d‚Äôarriv√©e.</p>
<p>Dans les exemples de commandes pr√©c√©dents, les param√®tres √©taient pass√©s en mode positionnel : l‚Äôex√©cutable attend des arguments dans un certain ordre, ce qui est clair dans le cas de <code>cp</code> par exemple. Mais le nombre des arguments n‚Äôest pas toujours fix√© √† l‚Äôavance, du fait de la pr√©sence de param√®tres optionnels. Ainsi, la plupart des ex√©cutables permettent le passage d‚Äôarguments optionnels, qui modifient le comportement de l‚Äôex√©cutable, via des <em>flags</em>. Par exemple, on a vu que <code>cp</code> permettait de copier un fichier √† un autre endroit du <em>filesystem</em>, mais peut-on copier un dossier et l‚Äôensemble de son contenu avec ? Nativement non, mais l‚Äôajout d‚Äôun param√®tre le permet : <code>cp -R dossierdepart dossierarrivee</code> permet de copier <em>r√©cursivement</em> le dossier et tout son contenu. Notons que les <em>flags</em> ont tr√®s souvent un √©quivalent en toute lettre, qui s‚Äô√©crit quant √† lui avec deux tirers. Par exemple, la commande pr√©c√©dente peut s‚Äô√©crire de mani√®re √©quivalente <code>cp --recursive dossierdepart dossierarrivee</code>. Il est fr√©quent de voir les deux syntaxes en pratique, parfois m√™me m√©lang√©es au sein d‚Äôune m√™me commande.</p>
</section>
</section>
<section id="variables-denvironnement" class="level2">
<h2 class="anchored" data-anchor-id="variables-denvironnement">Variables d‚Äôenvironnement</h2>
<p>Comme tout langage de programmation, le langage <code>shell</code> permet d‚Äôassigner et d‚Äôutiliser des variables dans des commandes. Pour afficher le contenu d‚Äôune variable, on utilise la commande <code>echo</code>, qui est l‚Äô√©quivalent de la fonction <code>print</code> en <code>Python</code> ou en <code>R</code>.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb3" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> MY_VAR=<span class="st">"toto"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="va">$MY_VAR</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb4" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>toto</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Quelques remarques importantes :</p>
<ul>
<li>la syntaxe pour la cr√©ation de variable est pr√©cise : aucun espace d‚Äôun c√¥t√© comme de l‚Äôautre du <code>=</code> ;</li>
<li>en <code>Shell</code>, on ne manipule que du texte. Dans notre exemple, on aurait donc pu √©crire <code>MY_VAR=toto</code> pour le m√™me r√©sultat. Par contre, si l‚Äôon veut assigner √† une variable une valeur contenant des espaces, les guillemets deviennent indispensables pour ne pas obtenir un message d‚Äôerreur ;</li>
<li>pour acc√©der √† la valeur d‚Äôune variable, on la pr√©fixe d‚Äôun <code>$</code>.</li>
</ul>
<p>Notre objectif avec ce tutoriel n‚Äôest pas de savoir coder en <code>shell</code>, on ne va donc pas s‚Äôattarder sur les propri√©t√©s des variables. En revanche, introduire ce concept √©tait n√©cessaire pour en pr√©senter un autre, essentiel quant √† lui dans la pratique quotidienne du data scientist : les variables d‚Äôenvironnement. Pour faire une analogie ‚Äî un peu simpliste ‚Äî avec les langages de programmation, ce sont des sortes de variables ‚Äúglobales‚Äù, dans la mesure o√π elles vont √™tre accessibles √† tous les programmes lanc√©s √† partir d‚Äôun terminal, et vont modifier leur comportement.</p>
<p>La liste des variables d‚Äôenvironnement peut √™tre affich√©e √† l‚Äôaide de la commande <code>env</code>. Il y a g√©n√©ralement un grand nombre de variables d‚Äôenvironnement pr√©√©xistantes ; en voici un √©chantillon obtenu √† partir du terminal du service VSCode.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb5" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> env</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb6" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>SHELL<span class="op">=/</span><span class="bu">bin</span><span class="op">/</span>bash</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>HOME<span class="op">=/</span>home<span class="op">/</span>coder</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>LANG<span class="op">=</span>en_US.UTF<span class="op">-</span><span class="dv">8</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>CONDA_PYTHON_EXE<span class="op">=/</span>home<span class="op">/</span>coder<span class="op">/</span>local<span class="op">/</span><span class="bu">bin</span><span class="op">/</span>conda<span class="op">/</span><span class="bu">bin</span><span class="op">/</span>python</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Cette liste illustre la vari√©t√© des utilisations des variables d‚Äôenvironnements :</p>
<ul>
<li>la variable <code>$SHELL</code> pr√©cise l‚Äôex√©cutable utilis√© pour lancer le terminal ;</li>
<li>la variable <code>$HOME</code> donne l‚Äôemplacement du r√©pertoire utilisateur. En fait, le symbole <code>~</code> que l‚Äôon a rencontr√© plus haut r√©f√©rence cette m√™me variable ;</li>
<li>la variable <code>LANG</code> sp√©cifie la <em>locale</em>, un concept qui permet de d√©finir la langue et l‚Äôencodage utilis√©s par d√©faut par Linux ;</li>
<li>la variable <code>CONDA_PYTHON_EXE</code> existe uniquement parce que l‚Äôon a install√© <code>conda</code> comme syst√®me de gestion de packages <code>Python</code>. C‚Äôest l‚Äôexistence de cette variable qui fait que la commande <code>python mon_script.py</code> va utiliser comme binaire la version de <code>Python</code> qui nous int√©resse.</li>
</ul>
<p>Une variable d‚Äôenvironnement essentielle, et que l‚Äôon est fr√©quemment amen√© √† modifier dans les applications de data science, est la variable <code>$PATH</code>. Elle consiste en une concat√©nation de chemins absolus, s√©par√©s par <code>:</code>, qui sp√©cifie les dossiers dans lesquels Linux va chercher les ex√©cutables lorsque l‚Äôon lance une commande, ainsi que l‚Äôordre de la recherche. Regardons la valeur du <code>$PATH</code> sur le terminal du service VSCode.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb7" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="va">$PATH</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb8" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">/</span>home<span class="op">/</span>coder<span class="op">/</span>local<span class="op">/</span><span class="bu">bin</span><span class="op">/</span>conda<span class="op">/</span><span class="bu">bin</span>:<span class="op">/</span>home<span class="op">/</span>coder<span class="op">/</span>local<span class="op">/</span><span class="bu">bin</span><span class="op">/</span>conda<span class="op">/</span>condabin:<span class="op">/</span>home<span class="op">/</span>coder<span class="op">/</span>local<span class="op">/</span><span class="bu">bin</span><span class="op">/</span>conda<span class="op">/</span>envs<span class="op">/</span>basesspcloud<span class="op">/</span><span class="bu">bin</span>:<span class="op">/</span>home<span class="op">/</span>coder<span class="op">/</span>local<span class="op">/</span><span class="bu">bin</span><span class="op">/</span>conda<span class="op">/</span><span class="bu">bin</span>:<span class="op">/</span>usr<span class="op">/</span>local<span class="op">/</span>sbin:<span class="op">/</span>usr<span class="op">/</span>local<span class="op">/</span><span class="bu">bin</span>:<span class="op">/</span>usr<span class="op">/</span>sbin:<span class="op">/</span>usr<span class="op">/</span><span class="bu">bin</span>:<span class="op">/</span>sbin:<span class="op">/</span><span class="bu">bin</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>L‚Äôordre de recherche est de gauche √† droite. C‚Äôest donc parce que le dossier <code>/home/coder/local/bin/conda/bin</code> est situ√© en premier que l‚Äôinterpr√©teur <code>Python</code> qui sera choisi lorsque l‚Äôon lance un script <code>Python</code> est celui issu de <code>Conda</code>, et non celui contenu par d√©faut dans <code>/usr/bin</code> par exemple.</p>
<p>L‚Äôexistence et la configuration ad√©quate des variables d‚Äôenvironnement est essentielle pour le bon fonctionnement de nombreux outils tr√®s utilis√©s en data science, comme <code>Git</code> ou encore <code>Spark</code> par exemple. Il est donc n√©cessaire de comprendre leur fonctionnement pour pouvoir lire des documentations techniques et adapter la configuration d‚Äôun serveur en cas de bug li√© √† une variable d‚Äôenvironnement manquante ou mal configur√©e.</p>
</section>
<section id="permissions" class="level2">
<h2 class="anchored" data-anchor-id="permissions">Permissions</h2>
<p>La s√©curit√© est un enjeu central en Linux, qui permet une gestion tr√®s fine des permissions sur les diff√©rents fichiers et programmes.</p>
<p>Une diff√©rence majeure par rapport √† d‚Äôautres syst√®mes d‚Äôexploitation, notamment Windows, est qu‚Äôaucun utilisateur n‚Äôa par d√©faut les droits complets d‚Äôadministrateur (<em>root</em>). Il n‚Äôest donc pas possible nativement d‚Äôacc√©der au parties sensibles du syst√®me, ou bien de lancer certains types de programme. Par exemple, si l‚Äôon essaie de lister les fichiers du dossier <code>/root</code>, on obtient une erreur.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb9" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> ls /root</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb10" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ls: cannot <span class="bu">open</span> directory <span class="st">'/root'</span>: Permission denied</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Dans la pratique du quotidien, certaines op√©rations telles que l‚Äôinstallation de binaires ou de packages n√©cessitent cependant des droits administrateurs. Dans ce cas, il est d‚Äôusage d‚Äôutiliser la commande <code>sudo</code> (Substitute User DO), qui permet de prendre les droits <em>root</em> le temps de l‚Äôex√©cution de la commande.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb11" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo ls /root</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Le dossier <code>/root</code> √©tant vide, la commande <code>ls</code> renvoie une cha√Æne de caract√®res vide, mais nous n‚Äôavons plus de probl√®me de permission. Notons qu‚Äôune bonne pratique de s√©curit√©, en particulier dans les scripts <code>shell</code> que l‚Äôon peut √™tre amen√©s √† √©crire ou ex√©cuter, est de limiter l‚Äôutilisation de cette commande aux cas o√π elle s‚Äôav√®re n√©cessaire.</p>
<p>Une autre subtilit√© concerne justement l‚Äôex√©cution de scripts <code>shell</code>. Par d√©faut, qu‚Äôil soit cr√©√© par l‚Äôutilisateur ou t√©l√©charg√© d‚Äôinternet, un script n‚Äôest pas ex√©cutable.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="annotated-cell-12" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-annotation-code code-with-copy code-annotated"><code class="sourceCode bash"><a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-12-1" class="code-annotation-target"><a href="#annotated-cell-12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> touch test.sh</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-12-2" class="code-annotation-target"><a href="#annotated-cell-12-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> ./test.sh</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-12" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="1" data-code-annotation="1">Cr√©er le script test.sh (vide)</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="2" data-code-annotation="2">Ex√©cuter le script test.sh</span>
</dd>
</dl>
<div class="sourceCode" id="cb12" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>bash: .<span class="op">/</span>test.sh: Permission denied</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>C‚Äôest bien entendu une mesure de s√©curit√© pour √©viter l‚Äôex√©cution automatique de scripts potentiellement malveillants. Pour pouvoir ex√©cuter un tel script, il faut attribuer des droits d‚Äôex√©cution au fichier avec la commande <code>chmod</code>. Il devient alors possible d‚Äôex√©cuter le script classiquement.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="annotated-cell-14" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-annotation-code code-with-copy code-annotated"><code class="sourceCode bash"><a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-14-1" class="code-annotation-target"><a href="#annotated-cell-14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> chmod +x test.sh</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-14-2" class="code-annotation-target"><a href="#annotated-cell-14-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> ./test.sh</span>
<span id="annotated-cell-14-3"><a href="#annotated-cell-14-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> <span class="co"># Le script √©tant vide, il ne se passe rien</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-14" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="1" data-code-annotation="1">Donner des droits d‚Äôex√©cution au script <code>test.sh</code></span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="2" data-code-annotation="2">Ex√©cuter le script test.sh</span>
</dd>
</dl>
</section>
<section id="les-scripts-shell" class="level2">
<h2 class="anchored" data-anchor-id="les-scripts-shell">Les scripts shell</h2>
<p>Maintenant que nous avons vu les variables et les permissions, revenons sur les scripts <code>shell</code> pr√©c√©demment √©voqu√©s. A l‚Äôinstar d‚Äôun script <code>Python</code>, un script <code>shell</code> permet d‚Äôautomatiser une s√©rie de commandes lanc√©es dans un terminal. Le but de ce tutoriel n‚Äôest pas de savoir √©crire des scripts <code>shell</code> complexes, travail g√©n√©ralement d√©volu aux les <em>data engineers</em> ou les <em>sysadmin</em> (administrateurs syst√®me), mais de comprendre leur structure, leur fonctionnement, et de savoir lancer des scripts simples. Ces comp√©tences sont essentielles lorsque l‚Äôon se pr√©occupe de mise en production. A titre d‚Äôexemple, comme nous le verrons dans le chapitre sur la <a href="../chapters/portability.html">portabilit√©</a>, il est fr√©quent d‚Äôutiliser un script <code>shell</code> comme <em>entrypoint</em> d‚Äôune image <code>docker</code>, afin de sp√©cifier les commandes que doit lancer le conteneur lors de son initialisation.</p>
<p>Illustrons leur structure ainsi que leur fonctionnement √† l‚Äôaide d‚Äôun script simple. Consid√©rons les commandes suivantes, que l‚Äôon met dans un fichier <code>monscript.sh</code> dans le r√©pertoire courant.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb13" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> <span class="co">#!/bin/bash</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> SECTION=<span class="va">$1</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> CHAPTER=<span class="va">$2</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> FORMATION_DIR=/home/coder/work/formation</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> mkdir <span class="at">-p</span> <span class="va">$FORMATION_DIR</span>/<span class="va">$SECTION</span>/<span class="va">$CHAPTER</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> touch <span class="va">$FORMATION_DIR</span>/<span class="va">$SECTION</span>/<span class="va">$CHAPTER</span>/test.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Analysons la structure de ce script :</p>
<ul>
<li>la premi√®re ligne est classique, elle se nomme le <em>shebang</em> : elle indique au syst√®me quel interpr√©teur utiliser pour ex√©cuter ce script. Dans notre cas, et de mani√®re g√©n√©rale, on utilise <code>bash</code> (Bourne-Again SHell, l‚Äôimpl√©mentation moderne du <code>shell</code>) ;</li>
<li>les lignes 2 et 3 assignent √† des variables les arguments pass√©s au script dans la commande. Par d√©faut, ceux-ci sont assign√©s √† des variables <code>n</code> o√π <code>n</code> est la position de l‚Äôargument, en commen√ßant √† 1 ;</li>
<li>la ligne 4 assigne un chemin √† une variable</li>
<li>la ligne 5 cr√©e le chemin complet, d√©fini √† partir des variables cr√©√©es pr√©c√©demment. Le param√®tre <code>-p</code> est important : il pr√©cise √† <code>mkdir</code> d‚Äôagir de mani√®re r√©cursive, c‚Äôest √† dire de cr√©er les dossiers interm√©diaires qui n‚Äôexistent pas encore ;</li>
<li>la ligne 6 cr√©e un fichier texte vide dans le dossier cr√©√© avec la commande pr√©c√©dente.</li>
</ul>
<p>Ex√©cutons maintenant ce script, en prenant soin de lui donner les permission ad√©quates au pr√©alable.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb14" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> chmod +x monscript.sh</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> bash monscript.sh section2 chapitre3</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> ls formation/section1/chapitre2/</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb15" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>text.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Op√©ration r√©ussie : le dossier a bien √©t√© cr√©√© et contient un fichier <code>test.txt</code>.</p>
<p>Pour en savoir plus, une <a href="https://devhints.io/bash">Cheat Sheet</a> sur <code>bash</code> tr√®s bien r√©alis√©e.</p>
</section>
<section id="gestionnaire-de-paquets" class="level2">
<h2 class="anchored" data-anchor-id="gestionnaire-de-paquets">Gestionnaire de paquets</h2>
<p>Une diff√©rence fondamentale entre Linux et Windows tient √† la mani√®re dont on installe un logiciel. Sur Windows, on va chercher un installateur (un fichier ex√©cutable en <code>.exe</code>) sur le site du logiciel, et on l‚Äôex√©cute. En Linux, on passe g√©n√©ralement par un gestionnaire de packages qui va chercher les logiciels sur un r√©pertoire centralis√©, √† la mani√®re de <code>pip</code> en <code>Python</code> par exemple.</p>
<p>Pourquoi cette diff√©rence ? Une raison importante est que, contrairement √† Windows, il existe une multitude de distributions diff√©rentes de Linux (Debian, Ubuntu, Mint, etc.), qui fonctionnent diff√©remment et peuvent avoir diff√©rentes versions. En utilisant le <em>package manager</em> (gestionnaire de paquets) propre √† la distribution en question, on s‚Äôassure de t√©l√©charger le logiciel adapt√© √† sa distribution. Dans ce cours, on fait le choix d‚Äôutiliser une distribution <code>Debian</code> et son gestionnaire de paquets associ√© <code>apt</code>. <code>Debian</code> est en effet un choix populaire pour les servers de part sa stabilit√© et sa simplicit√©, et sera √©galement famili√®re aux utilisateurs d‚Äô<code>Ubuntu</code>, distribution tr√®s populaire pour les ordinateurs personnels et qui est bas√©e sur <code>Debian</code>.</p>
<p>L‚Äôutilisation d‚Äô<code>apt</code> est tr√®s simple. La seule difficult√© est de savoir le nom du paquet que l‚Äôon souhaite installer, ce qui n√©cessite en g√©n√©ral d‚Äôutiliser un moteur de recherche. L‚Äôinstallation de paquets est √©galement un cas o√π il faut utiliser <code>sudo</code>, puisque cela implique souvent l‚Äôacc√®s √† des r√©pertoires prot√©g√©s.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb16" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo apt install tree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb17" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Reading package lists... Done</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Building dependency tree... Done</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>Reading state information... Done</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>The following NEW packages will be installed:</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  tree</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> upgraded, <span class="dv">1</span> newly installed, <span class="dv">0</span> to remove <span class="kw">and</span> <span class="dv">0</span> <span class="kw">not</span> upgraded.</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>D√©sinstaller un package est √©galement simple : c‚Äôest l‚Äôop√©ration inverse. Par s√©curit√©, le terminal vous demande si vous √™tes s√ªr de votre choix en vous demandant de tapper la lettre y (yes) ou la lettre n.&nbsp;On peut passer automatiquement cette √©tape en ajoutant le param√®tre <code>-y</code></p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb18" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo apt remove <span class="at">-y</span> tree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb19" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Reading package lists... Done</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Building dependency tree... Done</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Reading state information... Done</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>The following packages will be REMOVED:</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  tree</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> upgraded, <span class="dv">0</span> newly installed, <span class="dv">1</span> to remove <span class="kw">and</span> <span class="dv">0</span> <span class="kw">not</span> upgraded.</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Avant d‚Äôinstaller un package, il est toujours pr√©f√©rable de mettre √† jour la base des packages, pour s‚Äôassurer qu‚Äôon obtiendra bien la derni√®re version.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb20" data-filename="terminal" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo apt update</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb21" data-code-line-numbers=""><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Hit:<span class="dv">1</span> http:<span class="op">//</span>deb.debian.org<span class="op">/</span>debian bullseye InRelease</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>Hit:<span class="dv">2</span> http:<span class="op">//</span>deb.debian.org<span class="op">/</span>debian bullseye<span class="op">-</span>updates InRelease</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Hit:<span class="dv">3</span> http:<span class="op">//</span>security.debian.org<span class="op">/</span>debian<span class="op">-</span>security bullseye<span class="op">-</span>security InRelease</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>Reading package lists... Done</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>Building dependency tree... Done</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>Reading state information... Done</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>All packages are up to date.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="tricks" class="level2">
<h2 class="anchored" data-anchor-id="tricks"><em>Tricks</em></h2>
<p>On l‚Äôa dit et redit : devenir √† l‚Äôaise avec le terminal Linux est essentiel et demande de la pratique. Il existe n√©anmoins quelques astuces qui peuvent grandement simplifier la vie et donc faciliter la prise de bonnes habitudes.</p>
<p>La premi√®re est l‚Äô<strong>autocompl√©tion</strong>. D√®s lors que vous √©crivez une commande contenant un nom d‚Äôex√©cutable, un chemin sur le <em>filesystem</em>, ou autre, n‚Äôh√©sitez pas √† utiliser la touche <code>TAB</code> (touche au-dessus de celle qui verrouille la majuscule) de votre clavier. Dans la majorit√© des cas, cela va vous faire gagner un temps pr√©cieux.</p>
<p>La deuxi√®me est de parcourir l‚Äô<strong>historique</strong> de commandes : la fl√®che vers le haut (‚Üë) permet de parcourir l‚Äôhistorique des commandes que vous avez pr√©c√©demment ex√©cut√©es. Chaque fois que vous appuyez sur cette touche, le terminal affiche la derni√®re commande ex√©cut√©e, en remontant dans l‚Äôhistorique √† chaque appui suppl√©mentaire.</p>
<p>La troisi√®me, dans le m√™me esprit que la deuxi√®me mais plus √©labor√©e, est la <strong>recherche</strong> inverse dans l‚Äôhistorique de commandes avec les touches <code>Ctrl+R</code>. Lorsque vous appuyez sur <code>Ctrl+R</code>, une invite de recherche appara√Æt. Vous pouvez alors commencer √† taper des caract√®res de la commande que vous recherchez. Le terminal cherchera dans l‚Äôhistorique des commandes la derni√®re commande correspondant √† ce que vous avez tap√©, et la montrera √† l‚Äô√©cran. Si ce n‚Äôest pas la commande exacte que vous cherchez, vous pouvez continuer √† taper pour affiner la recherche ou appuyer √† nouveau sur <code>Ctrl+R</code> pour rechercher la commande pr√©c√©dente correspondant √† vos crit√®res.</p>
<p>Une quatri√®me astuce, qui n‚Äôen est pas vraiment une, est de lire la <strong>documentation</strong> d‚Äôune commande lorsque l‚Äôon n‚Äôest pas s√ªr de sa syntaxe ou des param√®tres admissibles. Via le terminal, la documentation d‚Äôune commande peut √™tre affich√©e en ex√©cutant <code>man</code> suivie de la commande en question, par exemple : <code>man cp</code>. Comme il n‚Äôest pas toujours tr√®s pratique de lire de longs textes dans un petit terminal, on peut √©galement chercher la documentation d‚Äôune commande sur le site <a href="https://man7.org/linux/man-pages/index.html">man7</a>.</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ensae-reproductibilite\.github\.io\/website\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>